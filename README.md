# æ–‡æ¡£ååŒç¼–è¾‘æŠ€æœ¯ - æ¸è¿›å¼å­¦ä¹ é¡¹ç›®

> ç³»ç»Ÿå­¦ä¹ åœ¨çº¿æ–‡æ¡£ååŒç¼–è¾‘æŠ€æœ¯çš„æ·±æ°´åŒºçŸ¥è¯†

## ğŸ“š é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ª**é¡¹ç›®é©±åŠ¨çš„æ¸è¿›å¼å­¦ä¹ è·¯çº¿**ï¼Œé€šè¿‡ 6 ä¸ªç‹¬ç«‹ä½†é€’è¿›çš„é¡¹ç›®ï¼Œç³»ç»ŸæŒæ¡æ–‡æ¡£ååŒç¼–è¾‘çš„æ ¸å¿ƒæŠ€æœ¯ã€‚

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆQuillã€Slateã€Tiptapï¼‰
- æ–‡æ¡£æ•°æ®ç»“æ„ï¼ˆDeltaã€æ ‘å½¢ç»“æ„ï¼‰
- ååŒç®—æ³•ï¼ˆOTã€CRDTï¼‰
- å®æ—¶é€šä¿¡ï¼ˆWebSocketã€WebRTCï¼‰
- React 18 + TypeScript

## ğŸ¯ å­¦ä¹ è·¯çº¿å›¾

```
Phase 1: å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åŸºç¡€ (1å‘¨)
    â†“ æŒæ¡ç¼–è¾‘å™¨æ ¸å¿ƒAPIå’Œæ•°æ®ç»“æ„
Phase 2: æ–‡æ¡£æ•°æ®ç»“æ„ä¸æ“ä½œ (1.5å‘¨)
    â†“ ç†è§£ Operation å’Œ Delta æ¦‚å¿µ
Phase 3: å†å²è®°å½•ä¸æ’¤é”€é‡åš (1å‘¨)
    â†“ æŒæ¡å•æœºç‰ˆæœ¬çš„çŠ¶æ€ç®¡ç†
Phase 4: å®æ—¶é€šä¿¡åŸºç¡€è®¾æ–½ (0.5å‘¨)
    â†“ æ­å»º WebSocket ååŒæ¶æ„
Phase 5: ååŒç¼–è¾‘å¼•æ“ - OT æ–¹æ¡ˆ (2å‘¨) â­ï¸
    â†“ ç†è§£å†²çªè§£å†³çš„ç»å…¸æ–¹æ¡ˆ
Phase 6: ç°ä»£ååŒæ–¹æ¡ˆ - CRDT (1å‘¨) â­ï¸
    â†“ æŒæ¡ä¸šç•Œä¸»æµçš„å®ç°
```

**æ€»è®¡ï¼šæ ¸å¿ƒè·¯å¾„ 6-7 å‘¨**

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
doc-learning/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ 01-rich-text-editor-foundation/    # Phase 1: çº¯ JS + Vite
â”‚   â”œâ”€â”€ 02-document-model-operations/      # Phase 2: TS + ç®—æ³•
â”‚   â”œâ”€â”€ 03-history-undo-redo/              # Phase 3: TS + React
â”‚   â”œâ”€â”€ 04-realtime-infrastructure/        # Phase 4: Monorepo å‰åç«¯
â”‚   â”œâ”€â”€ 05-collaborative-ot-engine/        # Phase 5: OT ååŒ
â”‚   â””â”€â”€ 06-collaborative-crdt-yjs/         # Phase 6: CRDT ååŒ
â”œâ”€â”€ docs/                                   # å…¨å±€æ–‡æ¡£
â”‚   â”œâ”€â”€ learning-roadmap.md                # å­¦ä¹ è·¯çº¿è¯¦è§£
â”‚   â”œâ”€â”€ tech-comparison.md                 # æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”
â”‚   â””â”€â”€ resources.md                       # å­¦ä¹ èµ„æºæ±‡æ€»
â”œâ”€â”€ package.json                           # æ ¹é…ç½®
â””â”€â”€ pnpm-workspace.yaml                    # Workspace é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18
- pnpm >= 8

### å®‰è£…ä¾èµ–
```bash
pnpm install
```

### è¿è¡Œé¡¹ç›®

#### è¿è¡Œ Phase 1ï¼ˆå½“å‰é˜¶æ®µï¼‰
```bash
pnpm dev:phase1
```

#### è¿è¡Œæ‰€æœ‰é¡¹ç›®
```bash
pnpm dev
```

#### è¿è¡ŒæŒ‡å®šé˜¶æ®µ
```bash
pnpm dev:phase2  # Phase 2
pnpm dev:phase3  # Phase 3
# ... ä»¥æ­¤ç±»æ¨
```

## ğŸ“– å„é˜¶æ®µè¯¦æƒ…

### Phase 1: å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åŸºç¡€
**æŠ€æœ¯æ ˆï¼š** çº¯ JavaScript + Vite + Quill.js  
**å­¦ä¹ ç›®æ ‡ï¼š**
- âœ… ç†è§£ ContentEditable å’Œ Selection API
- âœ… æŒæ¡å¯Œæ–‡æœ¬æ•°æ®ç»“æ„ï¼ˆDelta æ ¼å¼ï¼‰
- âœ… å®ç°åŸºæœ¬çš„æ ¼å¼åŒ–åŠŸèƒ½

**æ ¸å¿ƒæ–‡ä»¶ï¼š**
- `packages/01-rich-text-editor-foundation/src/editor.js` - ç¼–è¾‘å™¨æ ¸å¿ƒ
- `packages/01-rich-text-editor-foundation/docs/` - ç†è®ºæ–‡æ¡£

### Phase 2: æ–‡æ¡£æ•°æ®ç»“æ„ä¸æ“ä½œ
**æŠ€æœ¯æ ˆï¼š** TypeScript + Vitest  
**å­¦ä¹ ç›®æ ‡ï¼š**
- âœ… æ·±å…¥ç†è§£ Operationï¼ˆæ“ä½œï¼‰çš„æ¦‚å¿µ
- âœ… å®ç°æ“ä½œçš„ applyã€invertã€compose
- âœ… å¯¹æ¯”æ‰å¹³åŒ– vs æ ‘å½¢ç»“æ„

### Phase 3: å†å²è®°å½•ä¸æ’¤é”€é‡åš
**æŠ€æœ¯æ ˆï¼š** TypeScript + React + Immer  
**å­¦ä¹ ç›®æ ‡ï¼š**
- âœ… å®ç°å•ç”¨æˆ·çš„æ’¤é”€é‡åšæ ˆ
- âœ… å†å²å¿«ç…§å’Œæ—¶é—´æ—…è¡Œ
- âœ… æœ¬åœ°æŒä¹…åŒ–ï¼ˆIndexedDBï¼‰

### Phase 4: å®æ—¶é€šä¿¡åŸºç¡€è®¾æ–½
**æŠ€æœ¯æ ˆï¼š** TypeScript + React + Node.js + WebSocket  
**å­¦ä¹ ç›®æ ‡ï¼š**
- âœ… æ­å»º WebSocket å®æ—¶é€šä¿¡æ¶æ„
- âœ… æˆ¿é—´ç®¡ç†å’Œç”¨æˆ·åœ¨çº¿çŠ¶æ€
- âœ… è¿œç¨‹å…‰æ ‡æ˜¾ç¤º

### Phase 5: ååŒç¼–è¾‘å¼•æ“ï¼ˆOT æ–¹æ¡ˆï¼‰â­ï¸
**æŠ€æœ¯æ ˆï¼š** TypeScript + React + Node.js + è‡ªå®ç° OT  
**å­¦ä¹ ç›®æ ‡ï¼š**
- âœ… ç†è§£ OT ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³
- âœ… å®ç° Transform å‡½æ•°
- âœ… æŒæ¡ä¸­å¿ƒåŒ–ååŒæ¶æ„

### Phase 6: ç°ä»£ååŒæ–¹æ¡ˆï¼ˆCRDTï¼‰â­ï¸
**æŠ€æœ¯æ ˆï¼š** TypeScript + React + Yjs + Tiptap  
**å­¦ä¹ ç›®æ ‡ï¼š**
- âœ… ç†è§£ CRDT çš„æ ¸å¿ƒæ€æƒ³
- âœ… ä½¿ç”¨ Yjs å®ç°ç”Ÿäº§çº§ååŒ
- âœ… æ”¯æŒç¦»çº¿ç¼–è¾‘å’Œ P2P ååŒ

## ğŸ“ å­¦ä¹ æ–¹æ³•

### æ¯ä¸ªé¡¹ç›®çš„æ ‡å‡†æµç¨‹

1. **ç†è®ºå…ˆè¡Œ**ï¼ˆ1-2å¤©ï¼‰
   - é˜…è¯» `docs/` ç›®å½•ä¸‹çš„ç†è®ºæ–‡æ¡£
   - ç†è§£æ ¸å¿ƒæ¦‚å¿µå’Œè®¾è®¡åŸç†

2. **æœ€å°å®ç°**ï¼ˆ2-3å¤©ï¼‰
   - å®ç°æ ¸å¿ƒåŠŸèƒ½
   - ä¸è¿½æ±‚å®Œç¾ï¼Œèƒ½è·‘é€šå³å¯

3. **å®è·µéªŒè¯**ï¼ˆ1-2å¤©ï¼‰
   - å†™æµ‹è¯•ç”¨ä¾‹
   - éªŒè¯å„ç§åœºæ™¯

4. **æ–‡æ¡£åŒæ­¥**ï¼ˆ1å¤©ï¼‰
   - è¡¥å……å®ç°æ–‡æ¡£
   - è®°å½•è¸©å‘ç»éªŒ

### æ¨èçš„å­¦ä¹ è·¯å¾„

#### ğŸƒ å¿«é€Ÿè·¯å¾„ï¼ˆ3å‘¨ï¼‰
é€‚åˆé¢è¯•/å·¥ä½œéœ€è¦
```
Phase 1 â†’ Phase 4 â†’ Phase 6
```

#### ğŸš¶ å®Œæ•´è·¯å¾„ï¼ˆ6-7å‘¨ï¼‰
é€‚åˆæ·±åº¦å­¦ä¹ 
```
Phase 1 â†’ Phase 2 â†’ Phase 3 â†’ Phase 4 â†’ Phase 5 â†’ Phase 6
```

#### â­ï¸ å¹³è¡¡è·¯å¾„ï¼ˆ5å‘¨ï¼‰
æ¨èæ–¹æ¡ˆ
```
Phase 1 â†’ Phase 2 â†’ Phase 4 â†’ Phase 6 â†’ Phase 5ï¼ˆå›å¤´è¡¥ï¼‰
```

## ğŸ“š å­¦ä¹ èµ„æº

### å¼€æºé¡¹ç›®
- [Yjs](https://github.com/yjs/yjs) - æœ€æµè¡Œçš„ CRDT å®ç°
- [Quill](https://github.com/quilljs/quill) - ç®€å•ä¼˜é›…çš„ç¼–è¾‘å™¨
- [Slate](https://github.com/ianstormtaylor/slate) - å¯å®šåˆ¶æ€§å¼º
- [ProseMirror](https://github.com/ProseMirror/prosemirror) - æ¶æ„è®¾è®¡ä¼˜ç§€
- [Tiptap](https://github.com/ueberdosis/tiptap) - åŸºäº ProseMirror

### æ¨èæ–‡ç« 
- [OT ç®—æ³•åŸç†](https://operational-transformation.github.io/)
- [CRDT ç»¼è¿°](https://crdt.tech/)
- é£ä¹¦æ–‡æ¡£ååŒç¼–è¾‘å®è·µ

### è®ºæ–‡é˜…è¯»ï¼ˆå¯é€‰ï¼‰
- Ellis & Gibbs (1989) - OT ç»å…¸è®ºæ–‡
- Yjs YATA ç®—æ³•è®ºæ–‡

## ğŸ›  æŠ€æœ¯æ ˆå¯¹æ¯”

| é˜¶æ®µ | JS/TS | æ¡†æ¶ | å·¥ç¨‹åŒ– | æµ‹è¯• |
|------|-------|------|--------|------|
| Phase 1 | **JS** | æ—  | Vite | æ—  |
| Phase 2 | **TS** | æ—  | Vite | âœ… Vitest |
| Phase 3 | **TS** | React | Vite | âœ… Vitest |
| Phase 4 | **TS** | React + Node | Monorepo | âœ… Vitest |
| Phase 5 | **TS** | React + Node | å®Œæ•´ | âœ… å®Œæ•´ |
| Phase 6 | **TS** | React + Yjs | å®Œæ•´ | âœ… å®Œæ•´ |

## ğŸ¤ è´¡çŒ®æŒ‡å—

è¿™æ˜¯ä¸€ä¸ªä¸ªäººå­¦ä¹ é¡¹ç›®ï¼Œæ¬¢è¿ï¼š
- æå‡ºæ”¹è¿›å»ºè®®
- åˆ†äº«å­¦ä¹ å¿ƒå¾—
- è¡¥å……æ–‡æ¡£å’Œç¤ºä¾‹

## ğŸ“ License

MIT

---

**å¼€å§‹å­¦ä¹ ï¼š** è¿›å…¥ `packages/01-rich-text-editor-foundation` å¼€å§‹ Phase 1 ğŸš€

